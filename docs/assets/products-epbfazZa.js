import{r as d,u as w,j as e,L as v,i as I,b as P,F as E}from"./vendor-react-DD8gH1fO.js";import{g as C,a as S,s as B,b as L}from"./staticData-BQiDjMPt.js";import{L as $,P as q}from"./index-Bx21NJoI.js";import{N as R}from"./navigation-DK1LkUim.js";import{B as z}from"./back-button-Daeb0khH.js";function N({product:t,priority:a=!1}){const r=t.image&&t.image.trim()!=="",[h,x]=d.useState(!1),[s,f]=d.useState(!r),[g,m]=d.useState(a),o=d.useRef(null),l=w();d.useEffect(()=>{if(a||!o.current){m(!0);return}const c=new IntersectionObserver(i=>{i.forEach(n=>{n.isIntersecting&&(m(!0),c.disconnect())})},{rootMargin:"100px"});return c.observe(o.current),()=>c.disconnect()},[a]);const y=()=>{l.prefetchQuery({queryKey:[`/api/products/${t.id}`],queryFn:()=>C(t.id)}),r&&[t.image,...t.gallery||[]].filter(i=>i&&i.trim()!=="").forEach(i=>{const n=new Image;n.src=i})};return e.jsxs("div",{className:"group",onMouseEnter:y,ref:o,children:[e.jsx(v,{href:`/product/${t.id}`,children:e.jsxs("div",{className:"relative cursor-pointer mb-4",style:{aspectRatio:"3/4"},children:[!h&&!s&&e.jsx("div",{className:"absolute inset-0 bg-gray-50 flex items-center justify-center",children:e.jsx($,{size:"md"})}),s&&e.jsx("div",{className:"absolute inset-0 bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-400 text-sm",children:"Image unavailable"})}),g&&r&&!s&&e.jsx("img",{src:t.image,alt:t.CatalogueName||"Product image",className:`object-cover w-full h-full transition-all duration-300 group-hover:opacity-90 ${h?"opacity-100":"opacity-0"}`,loading:a?"eager":"lazy",decoding:"async",fetchPriority:a?"high":"auto",onLoad:()=>x(!0),onError:()=>f(!0),sizes:"(max-width: 768px) 50vw, 25vw"})]})}),e.jsxs("div",{className:"text-center space-y-2 min-h-[60px]",children:[e.jsx(v,{href:`/product/${t.id}`,children:e.jsx("h3",{className:"text-sm font-normal text-gray-900 leading-tight hover:text-gray-600 transition-colors cursor-pointer",children:t.CatalogueName||" "})}),e.jsxs("p",{className:"text-sm text-gray-900 font-light",children:[t.priceBYN||"0"," BYN / ",t.priceRUB||"0"," RUB"]})]})]})}function V(){const t=I(),a=t==null?void 0:t.category,r=t==null?void 0:t.query;d.useEffect(()=>{window.scrollTo(0,0)},[]);const h=a?[`/api/products/category/${a}`]:r?[`/api/products/search/${r}`]:["/api/products"],x=()=>a?S(a):r?B(r):L(),{data:s,isLoading:f}=P({queryKey:h,queryFn:x});let g="ВСЯ КОЛЛЕКЦИЯ";a?g=a==="bags"?"СУМКИ":a==="cosmetic bags"?"КОСМЕТИЧКИ":a==="нижнее белье"?"НИЖНЕЕ БЕЛЬЕ":a.toUpperCase():r&&(g=`ПОИСК: ${r}`);const m=((s==null?void 0:s.length)||0)>20,o=384,l=2,y=(o-48)/l,c=400,i=m&&s?Math.ceil(s.length/l):0;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(R,{}),e.jsx(z,{}),e.jsxs("div",{className:"container mx-auto px-6 pt-60 pb-16 max-w-md",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-xl font-normal tracking-[0.2em] text-gray-900 mb-3",children:g}),e.jsxs("p",{className:"text-sm text-gray-500 font-light",children:["(",(s==null?void 0:s.length)||0," Items)"]})]}),f?e.jsx("div",{className:"grid grid-cols-2 gap-6",children:[...Array(8)].map((n,u)=>e.jsx(q,{},u))}):m&&s?e.jsx("div",{style:{height:i*c,width:o},children:e.jsx(E,{columnCount:l,columnWidth:y,height:i*c,rowCount:i,rowHeight:c,width:o,style:{overflowX:"hidden"},children:({columnIndex:n,rowIndex:u,style:b})=>{const j=u*l+n,p=s[j];return p?e.jsx("div",{style:{...b,padding:"12px"},children:e.jsx(N,{product:p,priority:j<4})}):null}})}):e.jsx("div",{className:"grid grid-cols-2 gap-6",children:s==null?void 0:s.map((n,u)=>e.jsx(N,{product:n,priority:u<4},n.id))})]})]})}export{V as default};
