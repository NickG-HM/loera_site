import{r as d,u as w,j as e,L as v,f as I,a as P,F as E}from"./vendor-react-ByWCwTGe.js";import{g as C,a as S,s as B,b as L}from"./staticData-BQiDjMPt.js";import{L as $,P as q}from"./index-B6S9AHpb.js";import{N as R}from"./navigation-zEZZyTH7.js";import{B as z}from"./back-button-BsgzHr5b.js";import"./vendor-DFV2lSuA.js";import"./vendor-animations-CMPFBS9o.js";function N({product:t,priority:r=!1}){const a=t.image&&t.image.trim()!=="",[h,x]=d.useState(!1),[s,f]=d.useState(!a),[g,m]=d.useState(r),o=d.useRef(null),l=w();d.useEffect(()=>{if(r||!o.current){m(!0);return}const c=new IntersectionObserver(i=>{i.forEach(n=>{n.isIntersecting&&(m(!0),c.disconnect())})},{rootMargin:"100px"});return c.observe(o.current),()=>c.disconnect()},[r]);const y=()=>{l.prefetchQuery({queryKey:[`/api/products/${t.id}`],queryFn:()=>C(t.id)}),a&&[t.image,...t.gallery||[]].filter(i=>i&&i.trim()!=="").forEach(i=>{const n=new Image;n.src=i})};return e.jsxs("div",{className:"group",onMouseEnter:y,ref:o,children:[e.jsx(v,{href:`/product/${t.id}`,children:e.jsxs("div",{className:"relative cursor-pointer mb-4",style:{aspectRatio:"3/4"},children:[!h&&!s&&e.jsx("div",{className:"absolute inset-0 bg-gray-50 flex items-center justify-center",children:e.jsx($,{size:"md"})}),s&&e.jsx("div",{className:"absolute inset-0 bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-400 text-sm",children:"Image unavailable"})}),g&&a&&!s&&e.jsx("img",{src:t.image,alt:t.CatalogueName||"Product image",className:`object-cover w-full h-full transition-all duration-300 group-hover:opacity-90 ${h?"opacity-100":"opacity-0"}`,loading:r?"eager":"lazy",decoding:"async",fetchPriority:r?"high":"auto",onLoad:()=>x(!0),onError:()=>f(!0),sizes:"(max-width: 768px) 50vw, 25vw"})]})}),e.jsxs("div",{className:"text-center space-y-2 min-h-[60px]",children:[e.jsx(v,{href:`/product/${t.id}`,children:e.jsx("h3",{className:"text-sm font-normal text-gray-900 leading-tight hover:text-gray-600 transition-colors cursor-pointer",children:t.CatalogueName||" "})}),e.jsxs("p",{className:"text-sm text-gray-900 font-light",children:[t.priceBYN||"0"," BYN / ",t.priceRUB||"0"," RUB"]})]})]})}function T(){const t=I(),r=t==null?void 0:t.category,a=t==null?void 0:t.query;d.useEffect(()=>{window.scrollTo(0,0)},[]);const h=r?[`/api/products/category/${r}`]:a?[`/api/products/search/${a}`]:["/api/products"],x=()=>r?S(r):a?B(a):L(),{data:s,isLoading:f}=P({queryKey:h,queryFn:x});let g="ВСЯ КОЛЛЕКЦИЯ";r?g=r==="bags"?"СУМКИ":r==="cosmetic bags"?"КОСМЕТИЧКИ":r==="нижнее белье"?"НИЖНЕЕ БЕЛЬЕ":r.toUpperCase():a&&(g=`ПОИСК: ${a}`);const m=((s==null?void 0:s.length)||0)>20,o=384,l=2,y=(o-48)/l,c=400,i=m&&s?Math.ceil(s.length/l):0;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(R,{}),e.jsx(z,{}),e.jsxs("div",{className:"container mx-auto px-6 pt-60 pb-16 max-w-md",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-xl font-normal tracking-[0.2em] text-gray-900 mb-3",children:g}),e.jsxs("p",{className:"text-sm text-gray-500 font-light",children:["(",(s==null?void 0:s.length)||0," Items)"]})]}),f?e.jsx("div",{className:"grid grid-cols-2 gap-6",children:[...Array(8)].map((n,u)=>e.jsx(q,{},u))}):m&&s?e.jsx("div",{style:{height:i*c,width:o},children:e.jsx(E,{columnCount:l,columnWidth:y,height:i*c,rowCount:i,rowHeight:c,width:o,style:{overflowX:"hidden"},children:({columnIndex:n,rowIndex:u,style:b})=>{const j=u*l+n,p=s[j];return p?e.jsx("div",{style:{...b,padding:"12px"},children:e.jsx(N,{product:p,priority:j<4})}):null}})}):e.jsx("div",{className:"grid grid-cols-2 gap-6",children:s==null?void 0:s.map((n,u)=>e.jsx(N,{product:n,priority:u<4},n.id))})]})]})}export{T as default};
