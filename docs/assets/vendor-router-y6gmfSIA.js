import{e as H,p as N}from"./vendor-BDJ2vY3i.js";import{r as a,u as k}from"./vendor-react-CfA6xtrC.js";const U="popstate",v="pushState",g="replaceState",V="hashchange",x=[U,v,g,V],B=e=>{for(const t of x)addEventListener(t,e);return()=>{for(const t of x)removeEventListener(t,e)}},w=(e,t)=>H.useSyncExternalStore(B,e,t),I=()=>location.search,M=({ssrSearch:e=""}={})=>w(I,()=>e),R=()=>location.pathname,T=({ssrPath:e}={})=>w(R,e?()=>e:R),$=(e,{replace:t=!1,state:n=null}={})=>history[t?g:v](n,"",e),q=(e={})=>[T(e),$],C=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[C]>"u"){for(const e of[v,g]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,C,{value:!0})}const z=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",j=(e="")=>e==="/"?"":e,G=(e,t)=>e[0]==="~"?e.slice(1):j(t)+e,J=(e="",t)=>z(S(j(e)),S(t)),S=e=>{try{return decodeURI(e)}catch{return e}},O={hook:q,searchHook:M,parser:N,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},K=a.createContext(O),y=()=>a.useContext(K),_={},A=a.createContext(_),Q=()=>a.useContext(A),P=e=>{const[t,n]=e.hook(e);return[J(e.base,t),k((s,r)=>n(G(s,e.base),r))]},ee=()=>P(y()),D=(e,t,n,s)=>{const{pattern:r,keys:l}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),c=r.exec(n)||[],[f,...h]=c;return f!==void 0?[!0,(()=>{const o=l!==!1?Object.fromEntries(l.map((d,i)=>[d,h[i]])):c.groups;let u={...h};return o&&Object.assign(u,o),u})(),...s?[f]:[]]:[!1,null]},W=({children:e,...t})=>{var u,d;const n=y(),s=t.hook?O:n;let r=s;const[l,c]=((u=t.ssrPath)==null?void 0:u.split("?"))??[];c&&(t.ssrSearch=c,t.ssrPath=l),t.hrefs=t.hrefs??((d=t.hook)==null?void 0:d.hrefs);let f=a.useRef({}),h=f.current,o=h;for(let i in s){const p=i==="base"?s[i]+(t[i]||""):t[i]||s[i];h===o&&p!==o[i]&&(f.current=o={...o}),o[i]=p,(p!==s[i]||p!==r[i])&&(r=o)}return a.createElement(K.Provider,{value:r,children:e})},L=({children:e,component:t},n)=>t?a.createElement(t,{params:n}):typeof e=="function"?e(n):e,X=e=>{let t=a.useRef(_);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([s,r])=>r!==n[s])?e:n},te=({path:e,nest:t,match:n,...s})=>{const r=y(),[l]=P(r),[c,f,h]=n??D(r.parser,e,l,t),o=X({...Q(),...f});if(!c)return null;const u=h?a.createElement(W,{base:h},L(s,o)):L(s,o);return a.createElement(A.Provider,{value:o,children:u})},ne=a.forwardRef((e,t)=>{const n=y(),[s,r]=P(n),{to:l="",href:c=l,onClick:f,asChild:h,children:o,className:u,replace:d,state:i,...p}=e,E=k(m=>{m.ctrlKey||m.metaKey||m.altKey||m.shiftKey||m.button!==0||(f==null||f(m),m.defaultPrevented||(m.preventDefault(),r(c,e)))}),b=n.hrefs(c[0]==="~"?c.slice(1):n.base+c,n);return h&&a.isValidElement(o)?a.cloneElement(o,{onClick:E,href:b}):a.createElement("a",{...p,onClick:E,href:b,className:u!=null&&u.call?u(s===c):u,children:o,ref:t})}),F=e=>Array.isArray(e)?e.flatMap(t=>F(t&&t.type===a.Fragment?t.props.children:t)):[e],se=({children:e,location:t})=>{const n=y(),[s]=P(n);for(const r of F(e)){let l=0;if(a.isValidElement(r)&&(l=D(n.parser,r.props.path,t||s,r.props.nest))[0])return a.cloneElement(r,{match:l})}return null};export{ne as L,W as R,se as S,te as a,ee as b,Q as u};
